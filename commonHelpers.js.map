{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst apiKey = '14594113-3565582ddf884392468dadf7f';\nconst apiUrl = 'https://pixabay.com/api/';\nconst limit = 15;\n\nlet currentPage = 1;\nlet totalHits = 0;\n\nexport async function fetchImages(searchQuery, page = 1) {\n  const searchParams = new URLSearchParams({\n    key: apiKey,\n    q: searchQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: limit,\n    page,\n  });\n\n  const url = `${apiUrl}?${searchParams}`;\n\n  try {\n    const response = await axios.get(url);\n    totalHits = response.data.totalHits;\n    return response.data.hits;\n  } catch (error) {\n    totalHits = 0;\n    console.error('Error fetching images:', error);\n    return [];\n  }\n}\n\nexport function resetPage() {\n  currentPage = 1;\n}\n\nexport function incrementPage() {\n  currentPage += 1;\n}\n\nexport function getCurrentPage() {\n  return currentPage;\n}\n\nexport function getLimit() {\n  return limit;\n}\n\nexport function getTotalHits() {\n  return totalHits;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { getCurrentPage, getLimit, getTotalHits } from './pixabay-api';\n\nexport function renderGallery(imageArray) {\n  const galleryContainer = document.querySelector('.gallery');\n\n  if (!galleryContainer) {\n    console.error('Gallery container not found');\n    return;\n  }\n\n  const newItemsHTML = imageArray.map(generateGalleryItemHTML).join('');\n  galleryContainer.insertAdjacentHTML('beforeend', newItemsHTML);\n  initializeLightbox();\n}\n\nfunction generateGalleryItemHTML(image) {\n  const {\n    largeImageURL,\n    webformatURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  } = image;\n  return `\n    <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img\n          class=\"gallery-image\"\n          src=\"${webformatURL}\"\n          data-source=\"${largeImageURL}\"\n          alt=\"${tags}\"\n        />\n        <div class=\"image-details\">\n          ${generateDetailElementHTML('Likes', likes)}\n          ${generateDetailElementHTML('Views', views)}\n          ${generateDetailElementHTML('Comments', comments)}\n          ${generateDetailElementHTML('Downloads', downloads)}\n        </div>\n      </a>\n    </li>`;\n}\n\nfunction generateDetailElementHTML(title, value) {\n  return `\n    <div class=\"details-element\">\n      <p class=\"details-title\">${title}</p>\n      <p class=\"details-value\">${value}</p>\n    </div>`;\n}\n\nfunction initializeLightbox() {\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captions: true,\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n\n  lightbox.on('show.simplelightbox', function (e) {\n    e.preventDefault();\n  });\n\n  lightbox.on('error.simplelightbox', function (e) {\n    console.log(e); // some usefull information\n  });\n\n  lightbox.refresh();\n}\n\nexport function toggleLoader(isLoading) {\n  document.querySelector('.loader-wrapper').style.display = isLoading\n    ? 'flex'\n    : 'none';\n}\n\nexport function toggleLoadMoreButton(visible) {\n  document.querySelector('.load-more-button').style.display = visible\n    ? 'block'\n    : 'none';\n}\n\n// Check the end of the collection to display an alert\nexport function checkEndOfResults() {\n  const limit = getLimit();\n  const totalHits = getTotalHits();\n  const totalPages = Math.ceil(totalHits / limit);\n  const currentPage = getCurrentPage();\n\n  if (currentPage >= totalPages) {\n    toggleLoadMoreButton(false);\n    showErrorAlert(\n      \"We're sorry, but you've reached the end of search results.\"\n    );\n  } else {\n    toggleLoadMoreButton(true);\n  }\n}\n\nexport function showErrorAlert(message) {\n  return iziToast.error({\n    id: 'error',\n    position: 'topRight',\n    message: message,\n    transitionIn: 'fadeInDown',\n  });\n}\n\n// Function to scroll the page smoothly by the height of gallery items\nexport function scrollPageToNextGroup() {\n  const galleryItems = document.querySelectorAll('.gallery-item');\n  if (galleryItems.length === 0) return;\n\n  const firstItem = galleryItems[0];\n  const itemHeight = firstItem.getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: itemHeight * 2,\n    behavior: 'smooth',\n  });\n}\n","import {\n  fetchImages,\n  resetPage,\n  incrementPage,\n  getCurrentPage,\n} from './js/pixabay-api';\nimport {\n  renderGallery,\n  toggleLoader,\n  scrollPageToNextGroup,\n  toggleLoadMoreButton,\n  checkEndOfResults,\n  showErrorAlert,\n} from './js/render-functions';\n\nconst form = document.querySelector('.search-form');\nconst searchInput = document.querySelector('.search-input');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreButton = document.querySelector('.load-more-button');\n\nlet currentSearchQuery = '';\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  currentSearchQuery = searchInput.value.trim();\n  gallery.innerHTML = '';\n  toggleLoadMoreButton(false);\n\n  if (currentSearchQuery === '') {\n    showErrorAlert('The search field cannot be empty');\n    toggleLoader(false);\n  } else {\n    toggleLoader(true);\n    resetPage();\n    try {\n      const hits = await fetchImages(currentSearchQuery, getCurrentPage());\n      if (hits.length === 0) {\n        showErrorAlert(\n          'Sorry, there are no images matching your search query. Please try again!'\n        );\n      } else {\n        renderGallery(hits);\n        checkEndOfResults();\n        incrementPage();\n      }\n    } catch (error) {\n      console.error('Error:', error);\n      showErrorAlert(\n        'An error occurred while fetching images. Please try again later.'\n      );\n    } finally {\n      toggleLoader(false);\n      searchInput.value = '';\n    }\n  }\n});\n\nloadMoreButton.addEventListener('click', loadMoreImages);\n\nasync function loadMoreImages() {\n  toggleLoader(true);\n  try {\n    const hits = await fetchImages(currentSearchQuery, getCurrentPage());\n    if (hits.length > 0) {\n      renderGallery(hits);\n      scrollPageToNextGroup();\n      checkEndOfResults();\n      incrementPage();\n    } else {\n      toggleLoadMoreButton(false);\n    }\n  } catch (error) {\n    console.error('Error:', error);\n    showErrorAlert(\n      'An error occurred while fetching images. Please try again later.'\n    );\n  } finally {\n    toggleLoader(false);\n  }\n}\n"],"names":["apiKey","apiUrl","limit","currentPage","totalHits","fetchImages","searchQuery","page","searchParams","url","response","axios","error","resetPage","incrementPage","getCurrentPage","getLimit","getTotalHits","renderGallery","imageArray","galleryContainer","newItemsHTML","generateGalleryItemHTML","initializeLightbox","image","largeImageURL","webformatURL","tags","likes","views","comments","downloads","generateDetailElementHTML","title","value","lightbox","SimpleLightbox","e","toggleLoader","isLoading","toggleLoadMoreButton","visible","checkEndOfResults","totalPages","showErrorAlert","message","iziToast","scrollPageToNextGroup","galleryItems","itemHeight","form","searchInput","gallery","loadMoreButton","currentSearchQuery","event","hits","loadMoreImages"],"mappings":"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"}